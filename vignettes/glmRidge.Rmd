---
title: "Newton with ridge"
output: html_document
---

## Compare with glmnet
```{R message = F}
library("glmnet")
library("MixedGraphs")
n <- 200; p <- 500
s <- 6; ## True sparsity

set.seed(8)
X <- matrix(rnorm(n * p), ncol=p)
beta <- rep(0, p);
beta[1:s] <- runif(s, 4, 6) * c(-1, 1)
y <- X %*% beta + rnorm(n)
y <- y / sd(y)

glmnet_fit <- glmnet(X , y, alpha = 0, standardize=FALSE)
glmRidge_fit <- glmRidge(cbind(1, X), y, lambda = glmnet_fit$lambda, thresh = 1, intercept = TRUE)
```
```{R echo = FALSE}
plot(log(glmnet_fit$lambda), glmnet_fit$lambda,
     xlim=log(rev(range(glmnet_fit$lambda))),
     ylim=range(coef(glmnet_fit)),
     type="n", xlab=expression(log(lambda)),
     ylab=expression(hat(beta[j]^{lambda})),
     main="glmnet Paths")
for(i in 1:p){
      lines(log(glmnet_fit$lambda), coef(glmnet_fit)[i+1, ],
            col=ifelse(beta[i] == 0, "grey80", "red4"))
}

plot(log(glmnet_fit$lambda), glmnet_fit$lambda,
     xlim=log(rev(range(glmnet_fit$lambda))),
     ylim=range(coef(glmnet_fit)),
     type="n", xlab=expression(log(lambda)),
     ylab=expression(hat(beta[j]^{lambda})),
     main="MixedGraphs Paths")
for(i in 1:p){
      lines(log(glmnet_fit$lambda), glmRidge_fit[i+1, ],
            col=ifelse(beta[i] == 0, "grey80", "red4"))
}

```
