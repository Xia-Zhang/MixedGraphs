<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ADMM with lasso • MixedGraphs</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">MixedGraphs</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Algorithm
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/glmLasso.html">ADMM with Lasso</a>
    </li>
    <li>
      <a href="../articles/glmRidge.html">Newton with Ridge</a>
    </li>
    <li>
      <a href="../articles/BRAIL.html">BRAIL</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Plotting
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/igraph.html">igraph</a>
    </li>
    <li>
      <a href="../articles/Cytoscape.html">Cytoscape</a>
    </li>
    <li>
      <a href="../articles/Cytoscapejs.html">Cytoscapejs</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Xia-Zhang/MixedGraphs">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>ADMM with lasso</h1>
            
          </div>

    
    
<div class="contents">
<div id="admm" class="section level2">
<h2 class="hasAnchor">
<a href="#admm" class="anchor"></a>ADMM</h2>
<p><a href="http://stanford.edu/~boyd/admm.html">ADMM</a>(Alternating Direction Method of Multipliers) is an algorithm which breaking optimization problems into smaller pieces, and each of which are easier to handle. With it, we can easily deal with Lasso regression.</p>
</div>
<div id="lasso-regression" class="section level2">
<h2 class="hasAnchor">
<a href="#lasso-regression" class="anchor"></a>Lasso regression</h2>
<p>In MixedGraphs package, we support three different familys, “logistic”, “poisson” and “gaussian”.</p>
<div id="gaussian" class="section level3">
<h3 class="hasAnchor">
<a href="#gaussian" class="anchor"></a>Gaussian</h3>
\begin{align}
    f(\mathbf{\beta}) &amp;= \frac{1}{2n} {\| \mathbf{y} - \mathbf{o} - \mathbf{X} \mathbf{\beta} \|}_2^2+ \frac{1}{2} {\| \mathbf{\beta} - \mathbf{z^{(k-1)}} + \mathbf{u ^ {(k-1)}} \|}_2^2 \\
    \mathbf{\beta}^{(k)} &amp;= (\mathbf{X}^T \mathbf{X} / n + \mathbf{I})^{-1} \mathbf{X}^T(\mathbf{y} - \mathbf{o})/n  +
                  (\mathbf{X}^T \mathbf{X} / n + \mathbf{I})^{-1} (\mathbf{z}^{(k-1)} - \mathbf{u}^{(k-1)})
\end{align}
</div>
<div id="logistic" class="section level3">
<h3 class="hasAnchor">
<a href="#logistic" class="anchor"></a>Logistic</h3>
\begin{align}
    l(y_i; o_i + \mathbf{x_i\beta}) &amp;= - \log (1 + e ^ {o_i + \mathbf{x_i} \mathbf{\beta}}) + y_i(o_i + \mathbf{x_i}\mathbf{\beta}) \\
    f(\mathbf{\beta}) &amp;= \frac{1}{n} \sum_{i=1}^{n} [\log (1 + e ^ {o_i + \mathbf{x_i} \mathbf{\beta}}) - y_i(o_i + \mathbf{x_i} \mathbf{\beta})] + \frac{1}{2} {\| \mathbf{\beta} - \mathbf{z^{(k-1)}} + \mathbf{u ^ {(k-1)}} \|}_2^2 \\
    \nabla_\beta(f) &amp;= \big(\frac{1}{n} \sum_{i = 1}^{n}  \frac{x_{ij}}{1 + e ^ {- ({o_i + \mathbf{x_i}\mathbf{\beta}})}} - y_{i} x_{ij} \big)_j 
    + \mathbf{\beta} - \mathbf{z^{(k-1)}} + \mathbf{u^{(k-1)}} \\
    \mathcal{H}_\beta(f) &amp;= \big(\frac{1}{n} \sum_{i = 1}^{n} \frac{x_{ij}x_{jk}e ^ {- ({o_i + \mathbf{x_i}\mathbf{\beta}})} } {{(1 + e ^ {- ({o_i + \mathbf{x_i}\mathbf{\beta}})})}^2} \big)_{jk} + \mathbf{I}_{p\times p}
\end{align}
</div>
<div id="poisson" class="section level3">
<h3 class="hasAnchor">
<a href="#poisson" class="anchor"></a>Poisson</h3>
\begin{align}
    l(y_i; o_i + \mathbf{x_i\beta}) &amp;= y_i(o_i + \mathbf{x_i} \mathbf{\beta}) - e ^ {o_i + \mathbf{x_i} \mathbf{\beta}} \\
    f(\mathbf{\beta}) &amp;=  \frac{1}{n} \sum_{i=1}^{n} [- y_i(o_i + \mathbf{x_i} \mathbf{\beta}) + e ^ {o_i + \mathbf{x_i} \mathbf{\beta}} ]
    + \frac{1}{2} {\| \mathbf{\beta} - \mathbf{z^{(k-1)}} + \mathbf{u ^ {(k-1)}} \|}_2^2 \\
    \nabla_\beta(f) &amp;= \big( \frac{1}{n}  \sum_{i=1}^{n} - y_ix_{ij} + x_{ij} e ^ {o_i + \mathbf{x_i} \mathbf{\beta}}\big)_j
    + \mathbf{\beta} - \mathbf{z^{(k-1)}} + \mathbf{u^{(k-1)}}\\
    \mathcal{H}_\beta(f) &amp;= \frac{1}{n}(x_{ij}x_{jk}e^{o_i + \mathbf{x_i}\mathbf{\beta}})_{jk} + \mathbf{I}_{p\times p}
\end{align}
</div>
</div>
<div id="speed-up-tricks" class="section level2">
<h2 class="hasAnchor">
<a href="#speed-up-tricks" class="anchor"></a>Speed up tricks</h2>
<ul>
<li>
<h4 id="warm-start">warm start</h4>
Use the estimated fit from the previous run of Solver 1 as the initialization.</li>
<li>
<h4 id="early-stopping">early stopping</h4>
Stop the optimizer early when the support has not changed for a number of iterations.</li>
</ul>
</div>
<div id="compare-with-glmnet" class="section level2">
<h2 class="hasAnchor">
<a href="#compare-with-glmnet" class="anchor"></a>Compare with glmnet</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"glmnet"</span>)
<span class="kw">library</span>(<span class="st">"MixedGraphs"</span>)
n &lt;-<span class="st"> </span><span class="dv">200</span>; p &lt;-<span class="st"> </span><span class="dv">500</span>
s &lt;-<span class="st"> </span><span class="dv">6</span>; ## True sparsity

<span class="kw">set.seed</span>(<span class="dv">1</span>)
X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n *<span class="st"> </span>p), <span class="dt">ncol=</span>p)
beta &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, p)
beta[<span class="dv">1</span>:s] &lt;-<span class="st"> </span><span class="kw">runif</span>(s, <span class="dv">4</span>, <span class="dv">6</span>) *<span class="st"> </span><span class="kw">c</span>(-<span class="dv">1</span>, <span class="dv">1</span>)
y &lt;-<span class="st"> </span>X %*%<span class="st"> </span>beta +<span class="st"> </span><span class="kw">rnorm</span>(n)

glmnet_fit &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/glmnet/topics/glmnet">glmnet</a></span>(X, y, <span class="dt">standardize =</span> <span class="ot">FALSE</span>)
glmLasso_fit &lt;-<span class="st"> </span><span class="kw"><a href="../reference/glmLasso.html">glmLasso</a></span>(X, y, <span class="dt">lambda =</span> glmnet_fit$lambda, <span class="dt">support_stability =</span> <span class="dv">10</span>)</code></pre></div>
<p><img src="glmLasso_files/figure-html/unnamed-chunk-2-1.png" width="672"><img src="glmLasso_files/figure-html/unnamed-chunk-2-2.png" width="672"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#admm">ADMM</a></li>
      <li><a href="#lasso-regression">Lasso regression</a></li>
      <li><a href="#speed-up-tricks">Speed up tricks</a></li>
      <li><a href="#compare-with-glmnet">Compare with glmnet</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Xia Zhang, Michael Weylandt, Genevera Allen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
