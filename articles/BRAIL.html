<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BRAIL â€¢ MixedGraphs</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">MixedGraphs</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Algorithm
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/glmLasso.html">ADMM with Lasso</a>
    </li>
    <li>
      <a href="../articles/glmRidge.html">Newton with Ridge</a>
    </li>
    <li>
      <a href="../articles/BRAIL.html">BRAIL</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Plotting
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/igraph.html">igraph</a>
    </li>
    <li>
      <a href="../articles/Cytoscape.html">Cytoscape</a>
    </li>
    <li>
      <a href="../articles/Cytoscapejs.html">Cytoscapejs</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Xia-Zhang/MixedGraphs">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>BRAIL</h1>
            
          </div>

    
    
<div class="contents">
<p>BRAIL (Block Randomized Adaptive Iterative Lasso) is the key algorithm in MixedGraphs package.</p>
<div id="algorithm" class="section level3">
<h3 class="hasAnchor">
<a href="#algorithm" class="anchor"></a>Algorithm</h3>
Repeat through the blocks. For each block of the data, BRAIL will apply the adaptive lasso method to many bootstrap samples of the data. The levels of adaptive regularization is defined as,
\begin{align*}
\lambda_{k,j}^{(t)} = \begin{cases} \eta^{(t)}_k   &amp; \text{if } \hat{\beta}^{(t-1)}_{k,j} \neq 0, \\ 
                                                       2\eta^{(t)}_k &amp; \text{otherwise} \end{cases}
\end{align*}
where
\begin{equation*} 
\eta^{(t)}_k=\frac{\Lambda_{\max}(\widehat{\mathbf{\Theta}}^{(t-1)}_k)}{\Lambda_{\max}(\mathbf{X}^T\mathbf{X})} \  \frac{1}{\sqrt{n} } \|\hat{\mathbf{\beta}}^{(t-1)}_{k}\|_{2} \sqrt{\frac{\log( p_{k})}{n}\hspace{3pt} \|\hat{\mathbf{\beta}}^{(t-1)}_{k} \|_{0} } 
\end{equation*}
<p>The weight of the adaptive lasso is <span class="math inline">\(\gamma_j\lambda^{(t)}_{k,j}\)</span>, where <span class="math inline">\(\gamma_j \buildrel{iid}\over\sim \mathcal{U}([0.5, 1.5])\)</span>. BRAIL will select out the variable which support ratio reach the user input <span class="math inline">\(\tau\)</span>. The selected variables will do the Ridge regression to get the more accurate coeffients.</p>
<p>We will end the loop until the coeffients for all blocks stop changing.</p>
</div>
<div id="parallelization" class="section level3">
<h3 class="hasAnchor">
<a href="#parallelization" class="anchor"></a>Parallelization</h3>
<p>We use foreach package to implement the parallelization of BRAIL and Mixedgraph, which supports different backend, Multicore, Cluster, Cloud based (via Redis). User can register the backend according to theis specific needs and system. Many packages are available like <a href="https://cran.r-project.org/web/packages/doParallel/vignettes/gettingstartedParallel.pdf">doParallel</a>, <a href="https://cran.r-project.org/web/packages/doMC/vignettes/gettingstartedMC.pdf">doMC</a>, <a href="https://cran.r-project.org/web/packages/doSNOW/index.html">doSNOW</a>, and etc. Each parallel backend has its own registration function. For example, when register doParalle, we could</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(doParallel)
<span class="kw">registerDoParallel</span>(<span class="dt">cores=</span><span class="dv">2</span>)</code></pre></div>
<p>and for doMC,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(doMC)
<span class="kw">registerDoMC</span>(<span class="dv">2</span>)</code></pre></div>
<p>for doSNOW,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(doSNOW)
cl &lt;-<span class="st"> </span><span class="kw">makeCluster</span>(<span class="dv">2</span>, <span class="dt">type=</span><span class="st">"SOCK"</span>)
<span class="kw">registerDoSNOW</span>(cl)</code></pre></div>
</div>
<div id="code-example" class="section level3">
<h3 class="hasAnchor">
<a href="#code-example" class="anchor"></a>Code example:</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"MixedGraphs"</span>)
n &lt;-<span class="st"> </span><span class="dv">100</span>
p &lt;-<span class="st"> </span><span class="dv">50</span>
k &lt;-<span class="st"> </span><span class="dv">2</span>
<span class="kw">set.seed</span>(<span class="dv">2</span>)
beta &lt;-<span class="st"> </span><span class="kw">numeric</span>(p *<span class="st"> </span>k)
beta[<span class="dv">1</span>:<span class="dv">8</span>] &lt;-<span class="st"> </span><span class="dv">5</span>
beta[<span class="dv">51</span>:<span class="dv">53</span>] &lt;-<span class="st"> </span><span class="dv">3</span>
X &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span> :<span class="st"> </span>k, function(x) {
    <span class="kw">matrix</span>(<span class="kw">rnorm</span>(n *<span class="st"> </span>p), n, p)
})
y &lt;-<span class="st"> </span><span class="kw">do.call</span>(cbind, X) %*%<span class="st"> </span>beta +<span class="st"> </span><span class="kw">rnorm</span>(n)
brail_test &lt;-<span class="st"> </span><span class="kw"><a href="../reference/BRAIL.html">BRAIL</a></span>(X, y, <span class="dt">family =</span> <span class="st">"G"</span>)</code></pre></div>
<pre><code>## Warning: executing %dopar% sequentially: no parallel backend registered</code></pre>
<pre><code>## [1] "Truly coefficients: "</code></pre>
<pre><code>##   [1] 5 5 5 5 5 5 5 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
##  [36] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 3 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
##  [71] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</code></pre>
<pre><code>## [1] "BRAIL coefficients: "</code></pre>
<pre><code>## $coefficients
## $coefficients[[1]]
##  [1] 4.963742 5.212161 5.086796 4.896095 5.216079 4.751499 4.960975
##  [8] 5.018468 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000
## [15] 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000
## [22] 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000
## [29] 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000
## [36] 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000
## [43] 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000
## [50] 0.000000
## 
## $coefficients[[2]]
##  [1] 3.059511 2.955202 2.961144 0.000000 0.000000 0.000000 0.000000
##  [8] 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000
## [15] 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000
## [22] 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000
## [29] 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000
## [36] 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000
## [43] 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000
## [50] 0.000000
## 
## 
## $scores
## $scores[[1]]
##  [1] 1.000 1.000 1.000 1.000 1.000 1.000 1.000 1.000 0.000 0.000 0.000
## [12] 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.005 0.000
## [23] 0.000 0.000 0.000 0.000 0.000 0.005 0.000 0.000 0.005 0.000 0.000
## [34] 0.000 0.000 0.000 0.000 0.000 0.000 0.005 0.000 0.000 0.000 0.005
## [45] 0.000 0.000 0.000 0.025 0.000 0.005
## 
## $scores[[2]]
##  [1] 1.000 1.000 1.000 0.020 0.025 0.115 0.000 0.005 0.010 0.010 0.050
## [12] 0.020 0.005 0.005 0.050 0.090 0.005 0.025 0.080 0.015 0.010 0.000
## [23] 0.000 0.005 0.100 0.005 0.020 0.000 0.000 0.005 0.010 0.055 0.040
## [34] 0.025 0.010 0.035 0.005 0.055 0.055 0.015 0.065 0.030 0.015 0.040
## [45] 0.000 0.030 0.030 0.065 0.005 0.020</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Xia Zhang, Michael Weylandt, Genevera Allen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
